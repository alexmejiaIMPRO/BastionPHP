<!doctype html>
<html lang="en" class="dark">
<head>
  <meta charset="utf-8">
  <title>Bastion PHP Documentation - The Complete Guide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Comprehensive documentation for Bastion PHP. Security-first framework generator for internal tools.">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts: Inter & JetBrains Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

  <style>
    :root {
      --scroll-padding: 6rem;
    }
    
    html { 
      scroll-behavior: smooth; 
      scroll-padding-top: var(--scroll-padding); 
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: #020617; /* slate-950 */
      color: #e2e8f0; /* slate-200 */
    }

    /* Code Blocks */
    pre, code, kbd {
      font-family: 'JetBrains Mono', monospace;
    }

    code:not(pre code) {
      background: rgba(30, 41, 59, 0.5); /* slate-800/50 */
      color: #38bdf8; /* sky-400 */
      padding: 0.125rem 0.375rem;
      border-radius: 0.25rem;
      font-size: 0.875em;
      border: 1px solid rgba(51, 65, 85, 0.5);
    }

    .doc-code-block {
      background: #0f172a; /* slate-900 */
      border: 1px solid #1e293b; /* slate-800 */
      border-radius: 0.75rem;
      overflow: hidden;
      margin-bottom: 1.5rem;
    }

    .doc-code-header {
      background: #1e293b; /* slate-800 */
      padding: 0.5rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #334155;
      font-size: 0.75rem;
      color: #94a3b8;
    }

    .doc-code-content {
      padding: 1rem;
      overflow-x: auto;
      color: #e2e8f0;
      font-size: 0.875rem;
      line-height: 1.7;
    }

    /* Gradients */
    .text-gradient {
      background: linear-gradient(to right, #22d3ee, #3b82f6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Sidebar Navigation */
    .nav-link {
      display: block;
      padding: 0.5rem 0.75rem;
      color: #94a3b8; /* slate-400 */
      border-radius: 0.375rem;
      transition: all 0.2s;
      font-size: 0.875rem;
    }
    .nav-link:hover {
      color: #38bdf8;
      background: rgba(30, 41, 59, 0.5);
    }
    .nav-link.active {
      color: #38bdf8;
      background: rgba(6, 182, 212, 0.1);
      border-left: 2px solid #06b6d4;
    }

    /* Headings */
    h1, h2, h3, h4 { scroll-margin-top: var(--scroll-padding); }
    
    .section-title {
      font-size: 1.875rem;
      font-weight: 700;
      color: #f1f5f9;
      margin-bottom: 1.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid #1e293b;
    }

    .subsection-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #e2e8f0;
      margin-top: 2.5rem;
      margin-bottom: 1rem;
    }
    
    .card {
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid #1e293b;
        border-radius: 0.75rem;
        padding: 1.5rem;
    }

    /* Mobile Menu Animation */
    #sidebar {
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .sidebar-closed { transform: translateX(-100%); }
    .sidebar-open { transform: translateX(0); }
    
    @media (min-width: 1024px) {
      .sidebar-closed { transform: none; }
    }
  </style>
</head>
<body class="antialiased selection:bg-cyan-500/30">

  <!-- Header -->
  <header class="fixed top-0 w-full z-50 bg-slate-950/80 backdrop-blur-md border-b border-slate-800 h-16">
    <div class="max-w-[90rem] mx-auto px-4 h-full flex items-center justify-between">
      <div class="flex items-center gap-3">
        <button id="menu-btn" class="lg:hidden p-2 text-slate-400 hover:text-white">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </button>
        <div class="flex items-center gap-2">
          <div class="w-8 h-8 rounded bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center font-bold text-white text-sm">BP</div>
          <span class="font-bold text-lg tracking-tight">Bastion<span class="text-cyan-400">PHP</span></span>
        </div>
      </div>
      <div class="flex items-center gap-4 text-sm">
        <span class="text-slate-500 hidden sm:inline">v0.1.0</span>
        <a href="https://github.com/alexmejiaIMPRO/BastionPHP" target="_blank" class="text-slate-400 hover:text-white transition">GitHub</a>
      </div>
    </div>
  </header>

  <div class="max-w-[90rem] mx-auto flex pt-16 min-h-screen">
    
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar-closed fixed lg:sticky top-16 left-0 z-40 w-72 h-[calc(100vh-4rem)] bg-slate-950 border-r border-slate-800 overflow-y-auto lg:translate-x-0">
      <nav class="p-6 space-y-8">
        <div>
          <h5 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Getting Started</h5>
          <ul class="space-y-1">
            <li><a href="#intro" class="nav-link">Introduction</a></li>
            <li><a href="#installation" class="nav-link">Installation</a></li>
            <li><a href="#structure" class="nav-link">Project Structure</a></li>
          </ul>
        </div>
        
        <div>
          <h5 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Configuration</h5>
          <ul class="space-y-1">
            <li><a href="#config-files" class="nav-link">Config Files</a></li>
            <li><a href="#env-vars" class="nav-link">Environment (.env)</a></li>
          </ul>
        </div>

        <div>
          <h5 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Core Engine</h5>
          <ul class="space-y-1">
            <li><a href="#routing" class="nav-link">Routing & Layouts</a></li>
            <li><a href="#dv-engine" class="nav-link text-cyan-400">DV Engine (5 Patterns)</a></li>
            <li><a href="#api-server" class="nav-link">API & Endpoints</a></li>
            <li><a href="#middleware" class="nav-link">Middleware Pipeline</a></li>
          </ul>
        </div>

        <div>
          <h5 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Tools & Helpers</h5>
          <ul class="space-y-1">
            <li><a href="#db-querybuilder" class="nav-link">Database & ORM</a></li>
            <li><a href="#auth-security" class="nav-link">Auth & Security</a></li>
            <li><a href="#request-response" class="nav-link">Request & Response</a></li>
            <li><a href="#logging" class="nav-link">Logging</a></li>
            <li><a href="#global-helpers" class="nav-link">Global Helpers</a></li>
          </ul>
        </div>

        <div>
          <h5 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">CLI & Deploy</h5>
          <ul class="space-y-1">
            <li><a href="#cli-reference" class="nav-link">Bastion CLI</a></li>
            <li><a href="#deployment" class="nav-link">Deployment</a></li>
          </ul>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 min-w-0 px-4 sm:px-8 py-10">
      
      <!-- Intro -->
      <section id="intro" class="mb-16">
        <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight mb-6">
          Bastion <span class="text-gradient">PHP</span>
        </h1>
        <p class="text-xl text-slate-400 leading-relaxed max-w-3xl mb-8">
          A security-first, opinionated framework generator for building internal tools. 
          It combines <strong>Next.js-style file-based routing</strong>, <strong>FastAPI-like endpoints</strong>, 
          and a robust <strong>SQLite QueryBuilder</strong> into a single, cohesive package.
        </p>
        <div class="grid sm:grid-cols-3 gap-4">
          <div class="card bg-cyan-950/20 border-cyan-900/50">
            <div class="text-cyan-400 font-bold mb-1">Security First</div>
            <div class="text-sm text-slate-400">CSP Nonces, CSRF, and XSS protection enabled by default.</div>
          </div>
          <div class="card">
            <div class="text-purple-400 font-bold mb-1">Developer Experience</div>
            <div class="text-sm text-slate-400">Tailwind v4, Live Reload, and logical project structure.</div>
          </div>
          <div class="card">
            <div class="text-emerald-400 font-bold mb-1">Zero Magic</div>
            <div class="text-sm text-slate-400">Explicit routing and configuration. No hidden behaviors.</div>
          </div>
        </div>
      </section>

      <!-- Installation -->
      <section id="installation" class="mb-20">
        <h2 class="section-title">Installation</h2>
        <p class="mb-4 text-slate-400">Requires PHP 8.1+, Composer, and optionally Node.js for development.</p>
        
        <div class="doc-code-block">
          <div class="doc-code-header">Terminal</div>
          <div class="doc-code-content">
<pre><code># 1. Clone the generator
git clone https://github.com/alexmejiaIMPRO/BastionPHP.git
cd BastionPHP

# 2. Create your project
bash create-bastion-app MySecureApp

# 3. Enter and install
cd MySecureApp
composer install
npm install

# 4. Setup Database
./bastion migrate
./bastion seed

# 5. Start Dev Server
./bastion run-dev</code></pre>
          </div>
        </div>
      </section>

      <!-- Config Files -->
      <section id="config-files" class="mb-20">
        <h2 class="section-title">Configuration Files</h2>
        <p class="mb-6 text-slate-400">
          All configuration lives in the <code>config/</code> directory. Bastion loads these files lazily using the <code>config('filename.key')</code> helper.
        </p>

        <div class="space-y-8">
          <!-- App Config -->
          <div>
            <h3 class="text-xl font-bold text-slate-200 mb-2"><code>config/app.php</code></h3>
            <p class="text-sm text-slate-400 mb-3">General application identity and environment settings.</p>
            <div class="doc-code-block">
              <div class="doc-code-content">
<pre><code>return [
    'name'     => env('APP_NAME', 'Bastion App'),
    'env'      => env('APP_ENV', 'local'),      // 'local' or 'production'
    'debug'    => (bool) env('APP_DEBUG', false),
    'timezone' => env('APP_TIMEZONE', 'UTC'),   // Sets PHP default timezone
];</code></pre>
              </div>
            </div>
          </div>

          <!-- DB Config -->
          <div>
            <h3 class="text-xl font-bold text-slate-200 mb-2"><code>config/database.php</code></h3>
            <p class="text-sm text-slate-400 mb-3">Database connections. SQLite is the default.</p>
            <div class="doc-code-block">
              <div class="doc-code-content">
<pre><code>return [
    'default' => env('DB_CONNECTION', 'sqlite'),

    'connections' => [
        'sqlite' => [
            'driver' => 'sqlite',
            'path'   => env('DB_PATH', 'storage/db/app.db'),
        ],
        // MySQL configuration is also available here
    ],
];</code></pre>
              </div>
            </div>
          </div>

          <!-- Security Config -->
          <div>
            <h3 class="text-xl font-bold text-slate-200 mb-2"><code>config/security.php</code></h3>
            <p class="text-sm text-slate-400 mb-3">Toggles for the <code>SecurityHeaders</code> and <code>CsrfMiddleware</code>.</p>
            <div class="doc-code-block">
              <div class="doc-code-content">
<pre><code>return [
    'csrf_enabled'    => true,  // Validate _token on POST/PUT/DELETE
    'secure_cookies'  => false, // Set true in production (requires HTTPS)
    'same_site'       => 'Lax', // Cookie SameSite policy

    // Content Security Policy sources
    'csp_default_src' => ["'self'"],
    'csp_script_src'  => ["'self'", 'https://cdn.tailwindcss.com'],
];</code></pre>
              </div>
            </div>
          </div>

          <!-- Style Config -->
          <div>
            <h3 class="text-xl font-bold text-slate-200 mb-2"><code>config/style.php</code></h3>
            <p class="text-sm text-slate-400 mb-3">Theme settings and asset paths.</p>
            <div class="doc-code-block">
              <div class="doc-code-content">
<pre><code>return [
    'theme'    => env('APP_THEME', 'dark'),
    'css_path' => '/css/app.css', // Path to public asset
];</code></pre>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- DV Engine (Deep Dive) -->
      <section id="dv-engine" class="mb-20">
        <h2 class="section-title text-cyan-400">DV Engine Deep Dive</h2>
        <p class="mb-6 text-slate-300 leading-relaxed">
          The <strong>Data View (DV) Engine</strong> is a static state container (`App\Core\DV`) that allows pages to "bubble up" data to their parent layouts. 
          Since `page.php` is executed <em>before</em> `layout.php`, the page can define titles, breadcrumbs, or control sidebar visibility before the layout renders the HTML shell.
        </p>

        <h3 class="subsection-title">5 Essential Use Cases</h3>

        <!-- Case 1 -->
        <div class="mb-8">
          <h4 class="font-bold text-slate-200 mb-2">1. Dynamic Page Titles</h4>
          <p class="text-sm text-slate-400 mb-2">The most common use case. The page sets the title, the layout renders the <code>&lt;title&gt;</code> tag.</p>
          <div class="grid lg:grid-cols-2 gap-4">
            <div class="doc-code-block mb-0">
              <div class="doc-code-header">app/dashboard/page.php</div>
              <div class="doc-code-content">
<pre><code>use App\Core\DV;

// Set specific title
DV::set('title', 'Sales Dashboard');</code></pre>
              </div>
            </div>
            <div class="doc-code-block mb-0">
              <div class="doc-code-header">app/layout.php</div>
              <div class="doc-code-content">
<pre><code>// Get with fallback
$t = DV::get('title', 'Bastion');
echo "&lt;title&gt;" . e($t) . "&lt;/title&gt;";</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Case 2 -->
        <div class="mb-8">
          <h4 class="font-bold text-slate-200 mb-2">2. Breadcrumbs System</h4>
          <p class="text-sm text-slate-400 mb-2">Pass an array of links to render a navigation trail in the layout header.</p>
          <div class="doc-code-block">
              <div class="doc-code-header">app/admin/users/page.php</div>
              <div class="doc-code-content">
<pre><code>DV::set('breadcrumbs', [
    ['label' => 'Admin', 'url' => '/admin'],
    ['label' => 'Users', 'url' => '/admin/users'],
    ['label' => 'Edit',  'url' => null]
]);</code></pre>
              </div>
          </div>
        </div>

        <!-- Case 3 -->
        <div class="mb-8">
          <h4 class="font-bold text-slate-200 mb-2">3. Sidebar Visibility Control</h4>
          <p class="text-sm text-slate-400 mb-2">A login page or full-screen map might want to hide the main navigation.</p>
          <div class="grid lg:grid-cols-2 gap-4">
            <div class="doc-code-block mb-0">
              <div class="doc-code-header">app/login/page.php</div>
              <div class="doc-code-content">
<pre><code>// Disable sidebar for login
DV::set('show_sidebar', false);</code></pre>
              </div>
            </div>
            <div class="doc-code-block mb-0">
              <div class="doc-code-header">app/layout.php</div>
              <div class="doc-code-content">
<pre><code>if (DV::get('show_sidebar', true)) {
    include 'components/sidebar.php';
}</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Case 4 -->
        <div class="mb-8">
          <h4 class="font-bold text-slate-200 mb-2">4. Injecting Page-Specific Scripts</h4>
          <p class="text-sm text-slate-400 mb-2">Inject Chart.js or Maps API only on pages that need it, keeping other pages light.</p>
          <div class="doc-code-block">
              <div class="doc-code-header">app/analytics/page.php</div>
              <div class="doc-code-content">
<pre><code>DV::set('scripts', [
    'https://cdn.jsdelivr.net/npm/chart.js'
]);</code></pre>
              </div>
          </div>
        </div>

        <!-- Case 5 -->
        <div class="mb-8">
          <h4 class="font-bold text-slate-200 mb-2">5. Active Menu Highlighting</h4>
          <p class="text-sm text-slate-400 mb-2">Tell the layout which navbar item should be highlighted.</p>
          <div class="doc-code-block">
              <div class="doc-code-header">app/settings/profile/page.php</div>
              <div class="doc-code-content">
<pre><code>// Highlight the 'settings' tab
DV::set('current_tab', 'settings');</code></pre>
              </div>
          </div>
        </div>
      </section>

      <!-- Routing & Structure -->
      <section id="structure" class="mb-20">
        <h2 class="section-title">Project Structure & Routing</h2>
        <p class="mb-6 text-slate-400">Bastion uses <strong>filesystem-based routing</strong>. The folder structure inside `app/` determines your URLs.</p>

        <div class="grid lg:grid-cols-2 gap-8">
          <div>
            <h3 class="text-lg font-bold text-slate-200 mb-4">Core Directories</h3>
            <ul class="space-y-4">
              <li class="pl-4 border-l-2 border-slate-700">
                <code class="text-cyan-400">app/</code>
                <p class="text-sm text-slate-400 mt-1">Contains all pages, layouts, and API endpoints.</p>
              </li>
              <li class="pl-4 border-l-2 border-slate-700">
                <code class="text-cyan-400">src/</code>
                <p class="text-sm text-slate-400 mt-1">Application logic. Models, Services, Middleware, and Core files.</p>
              </li>
              <li class="pl-4 border-l-2 border-slate-700">
                <code class="text-cyan-400">config/</code>
                <p class="text-sm text-slate-400 mt-1">Configuration files loaded by helper.</p>
              </li>
              <li class="pl-4 border-l-2 border-slate-700">
                <code class="text-cyan-400">public/</code>
                <p class="text-sm text-slate-400 mt-1">Web root. Contains `index.php` and compiled assets.</p>
              </li>
            </ul>
          </div>
          <div>
            <h3 class="text-lg font-bold text-slate-200 mb-4">Routing Examples</h3>
            <table class="w-full text-sm text-left">
              <thead class="text-xs text-slate-500 uppercase bg-slate-900">
                <tr>
                  <th class="px-3 py-2">File Path</th>
                  <th class="px-3 py-2">URL</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-slate-800">
                <tr>
                  <td class="px-3 py-3 font-mono">app/page.php</td>
                  <td class="px-3 py-3 text-cyan-400">/</td>
                </tr>
                <tr>
                  <td class="px-3 py-3 font-mono">app/about/page.php</td>
                  <td class="px-3 py-3 text-cyan-400">/about</td>
                </tr>
                <tr>
                  <td class="px-3 py-3 font-mono">app/blog/[slug]/page.php</td>
                  <td class="px-3 py-3 text-cyan-400">/blog/my-post</td>
                </tr>
                <tr>
                  <td class="px-3 py-3 font-mono">app/api/users/+server.php</td>
                  <td class="px-3 py-3 text-purple-400">POST /api/users</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Tools & Helpers -->
      <section id="db-querybuilder" class="mb-20">
        <h2 class="section-title">Tools: Database & QueryBuilder</h2>
        <p class="mb-4 text-slate-400">
          Access the database via the <code>App\Core\DB</code> facade. It uses PDO and provides a fluent interface for SQLite and MySQL.
        </p>

        <div class="grid gap-6">
          <div class="card">
            <h4 class="text-cyan-400 font-mono mb-2">DB::table('name')</h4>
            <div class="doc-code-block mb-0">
              <div class="doc-code-content">
<pre><code>// Select with conditions
$users = DB::table('users')
    ->where('role', 'admin')
    ->where('active', 1)
    ->orderBy('created_at', 'DESC')
    ->limit(10)
    ->get(); // Returns array of arrays

// Get single row
$user = DB::table('users')->where('id', 5)->first();

// Insert (Returns ID)
$id = DB::table('logs')->insert([
    'action' => 'login',
    'user_id' => 1,
    'timestamp' => time()
]);

// Update
DB::table('users')
    ->where('id', 1)
    ->update(['status' => 'banned']);

// Delete
DB::table('users')->where('id', 1)->delete();</code></pre>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="auth-security" class="mb-20">
        <h2 class="section-title">Tools: Auth & Security</h2>
        
        <h3 class="subsection-title">Authentication (`App\Core\Auth`)</h3>
        <ul class="grid sm:grid-cols-2 gap-4 mb-8">
          <li class="card p-4">
            <code class="block text-cyan-400 mb-1">Auth::attempt($email, $pass)</code>
            <span class="text-sm text-slate-400">Validates credentials against `users` table and starts session.</span>
          </li>
          <li class="card p-4">
            <code class="block text-cyan-400 mb-1">Auth::user()</code>
            <span class="text-sm text-slate-400">Returns current user array or null.</span>
          </li>
          <li class="card p-4">
            <code class="block text-cyan-400 mb-1">Auth::check()</code>
            <span class="text-sm text-slate-400">Returns boolean true if logged in.</span>
          </li>
          <li class="card p-4">
            <code class="block text-cyan-400 mb-1">Auth::isAdmin()</code>
            <span class="text-sm text-slate-400">Checks if current user role is 'admin'.</span>
          </li>
        </ul>

        <h3 class="subsection-title">Security Helpers</h3>
        <p class="text-slate-400 mb-4">These are globally available functions.</p>
        
        <div class="space-y-4">
            <div class="doc-code-block">
                <div class="doc-code-header">1. Output Escaping (XSS Prevention)</div>
                <div class="doc-code-content">
<pre><code>&lt;!-- ALWAYS use e() for user content -->
&lt;p>Hello, &lt;?= e($user['name']) ?>&lt;/p></code></pre>
                </div>
            </div>

            <div class="doc-code-block">
                <div class="doc-code-header">2. CSRF Protection</div>
                <div class="doc-code-content">
<pre><code>&lt;form method="POST" action="/api/save">
    &lt;!-- Generates &lt;input type="hidden" name="_token" ...> -->
    &lt;?= csrf_field() ?>
    
    &lt;button type="submit">Save&lt;/button>
&lt;/form></code></pre>
                </div>
            </div>
        </div>
      </section>

      <section id="request-response" class="mb-20">
        <h2 class="section-title">Tools: Request & Response</h2>
        <p class="mb-6 text-slate-400">Used primarily within <code>+server.php</code> API files.</p>

        <div class="grid lg:grid-cols-2 gap-8">
          <div>
            <h3 class="text-lg font-bold text-slate-200 mb-3">Request Object</h3>
            <div class="doc-code-block">
              <div class="doc-code-content">
<pre><code>// Get POST body or GET param
$val = $req->input('key', 'default');

// Get URL param (from [id] folder)
$id = $req->path_param_id;

// Get HTTP Method
$method = $req->method; // 'GET', 'POST'

// Get Raw Body (JSON)
$data = $req->body;</code></pre>
              </div>
            </div>
          </div>
          <div>
            <h3 class="text-lg font-bold text-slate-200 mb-3">Response Helper</h3>
            <div class="doc-code-block">
              <div class="doc-code-content">
<pre><code>// Return JSON and exit
Response::json(['status' => 'ok'], 200);

// Redirect
Response::redirect('/login');

// Abort with error code
Response::abort(404, 'User not found');

// Render HTML
Response::html('&lt;h1>Error&lt;/h1>', 500);</code></pre>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <section id="logging" class="mb-20">
        <h2 class="section-title">Tools: Logging</h2>
        <p class="mb-4 text-slate-400">
            Simple file-based logging to `storage/logs/app.log`.
        </p>
        <div class="doc-code-block">
            <div class="doc-code-content">
<pre><code>// Log an info message
logger()->info('User logged in: ' . $email);

// Log an error
logger()->error('Database connection failed: ' . $e->getMessage());

// Available methods: debug, info, warning, error</code></pre>
            </div>
        </div>
      </section>

      <section id="global-helpers" class="mb-20">
        <h2 class="section-title">Global Helpers Reference</h2>
        <div class="overflow-x-auto">
          <table class="w-full text-sm text-left border-collapse">
            <thead class="text-xs text-slate-500 uppercase bg-slate-900 border border-slate-800">
              <tr>
                <th class="px-4 py-3 border border-slate-800">Helper</th>
                <th class="px-4 py-3 border border-slate-800">Return</th>
                <th class="px-4 py-3 border border-slate-800">Description</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-slate-800">
              <tr>
                <td class="px-4 py-3 font-mono text-cyan-400">e($str)</td>
                <td class="px-4 py-3 text-slate-400">string</td>
                <td class="px-4 py-3">Escapes string for safe HTML output.</td>
              </tr>
              <tr>
                <td class="px-4 py-3 font-mono text-cyan-400">env($key, $def)</td>
                <td class="px-4 py-3 text-slate-400">mixed</td>
                <td class="px-4 py-3">Reads from <code>.env</code> file.</td>
              </tr>
              <tr>
                <td class="px-4 py-3 font-mono text-cyan-400">config($key)</td>
                <td class="px-4 py-3 text-slate-400">mixed</td>
                <td class="px-4 py-3">Reads from <code>config/</code> files (dot notation).</td>
              </tr>
              <tr>
                <td class="px-4 py-3 font-mono text-cyan-400">csrf_token()</td>
                <td class="px-4 py-3 text-slate-400">string</td>
                <td class="px-4 py-3">Returns the current session CSRF token string.</td>
              </tr>
              <tr>
                <td class="px-4 py-3 font-mono text-cyan-400">csrf_field()</td>
                <td class="px-4 py-3 text-slate-400">html</td>
                <td class="px-4 py-3">Returns hidden input field with CSRF token.</td>
              </tr>
              <tr>
                <td class="px-4 py-3 font-mono text-cyan-400">dv_get($k, $d)</td>
                <td class="px-4 py-3 text-slate-400">mixed</td>
                <td class="px-4 py-3">Alias for <code>DV::get()</code>.</td>
              </tr>
              <tr>
                <td class="px-4 py-3 font-mono text-cyan-400">logger()</td>
                <td class="px-4 py-3 text-slate-400">Logger</td>
                <td class="px-4 py-3">Returns the global Logger instance.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- CLI Reference -->
      <section id="cli-reference" class="mb-20">
        <h2 class="section-title">CLI Reference</h2>
        <p class="mb-6 text-slate-400">The <code>./bastion</code> executable in the root directory is your main tool.</p>

        <div class="space-y-4">
          <div class="card bg-slate-900/40">
            <div class="flex items-center gap-3 mb-2">
              <code class="text-lg text-emerald-400">./bastion run-dev</code>
            </div>
            <p class="text-sm text-slate-400">
              Starts the full development stack:
              <br>1. PHP Built-in Server (:8000)
              <br>2. Tailwind v4 Watch Mode
              <br>3. BrowserSync Proxy (:9876) for live reload
            </p>
          </div>

          <div class="card bg-slate-900/40">
            <div class="flex items-center gap-3 mb-2">
              <code class="text-lg text-emerald-400">./bastion migrate</code>
            </div>
            <p class="text-sm text-slate-400">
              Executes all SQL files found in <code>database/migrations/</code> against the configured DB.
            </p>
          </div>

          <div class="card bg-slate-900/40">
            <div class="flex items-center gap-3 mb-2">
              <code class="text-lg text-emerald-400">./bastion seed</code>
            </div>
            <p class="text-sm text-slate-400">
              Runs PHP scripts found in <code>database/seeds/</code>. Useful for creating initial admin users or dummy data.
            </p>
          </div>
          
          <div class="card bg-slate-900/40">
            <div class="flex items-center gap-3 mb-2">
              <code class="text-lg text-emerald-400">./bastion build</code>
            </div>
            <p class="text-sm text-slate-400">
              Compiles and minifies CSS using Tailwind CLI for production deployment.
            </p>
          </div>
        </div>
      </section>
      
      <!-- Footer -->
      <footer class="pt-8 mt-20 border-t border-slate-800 text-center text-slate-500 text-sm">
        <p>&copy; 2024 Bastion PHP Framework. Created for internal tools.</p>
      </footer>

    </main>
    
    <!-- Table of Contents (Desktop Right) -->
    <aside class="hidden xl:block w-64 flex-shrink-0">
        <div class="sticky top-24 pr-8">
            <h5 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-4">On This Page</h5>
            <nav id="toc" class="space-y-2 text-sm border-l border-slate-800 pl-4">
                <!-- JS will populate this -->
            </nav>
        </div>
    </aside>

  </div>

  <script>
    // Sidebar Toggle
    const menuBtn = document.getElementById('menu-btn');
    const sidebar = document.getElementById('sidebar');
    
    menuBtn.addEventListener('click', () => {
      sidebar.classList.toggle('sidebar-closed');
      sidebar.classList.toggle('sidebar-open');
    });

    // Dynamic TOC Generation
    document.addEventListener('DOMContentLoaded', () => {
      const headings = document.querySelectorAll('main h2, main h3');
      const toc = document.getElementById('toc');
      
      headings.forEach(heading => {
        if (!heading.id) {
          heading.id = heading.innerText.toLowerCase().replace(/[^a-z0-9]+/g, '-');
        }
        
        const link = document.createElement('a');
        link.href = `#${heading.id}`;
        link.innerText = heading.innerText;
        link.className = `block text-slate-400 hover:text-cyan-400 transition-colors ${heading.tagName === 'H3' ? 'pl-4 text-xs' : ''}`;
        
        toc.appendChild(link);
      });
    });
  </script>
</body>
</html>
