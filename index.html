<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8">
  <title>Bastion Enterprise v1.0.0 ‚Äî The Monolith Modular Framework</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Official documentation for Bastion Enterprise. Secure, API-first PHP framework with Tailwind v4.">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <style>
    /* * BASTION DESIGN SYSTEM 
     * Theme: Deep Space / Enterprise Dark
     */
    :root {
      --bg-body: #020617;       /* Slate 950 */
      --bg-panel: #0f172a;      /* Slate 900 */
      --bg-card: #1e293b;       /* Slate 800 */
      --border: #334155;        /* Slate 700 */
      --text-main: #f8fafc;     /* Slate 50 */
      --text-muted: #94a3b8;    /* Slate 400 */
      
      --primary: #38bdf8;       /* Sky 400 */
      --primary-dim: rgba(56, 189, 248, 0.1);
      --secondary: #818cf8;     /* Indigo 400 */
      --accent: #2dd4bf;        /* Teal 400 */
      --danger: #ef4444;        /* Red 500 */
      --warning: #f59e0b;       /* Amber 500 */
      
      --code-bg: #0B1120;
      --sidebar-width: 280px;
      --header-height: 4rem;
    }

    /* Reset & Base */
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-body);
      color: var(--text-main);
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Typography */
    h1, h2, h3, h4, h5, h6 { color: #fff; font-weight: 700; letter-spacing: -0.025em; margin-top: 2.5rem; margin-bottom: 1rem; }
    h1 { font-size: 3rem; line-height: 1; background: linear-gradient(to right, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-top: 0; }
    h2 { font-size: 2rem; border-bottom: 1px solid var(--border); padding-bottom: 0.75rem; margin-top: 4rem; }
    h3 { font-size: 1.5rem; color: var(--text-main); }
    h4 { font-size: 1.25rem; color: var(--text-main); margin-top: 2rem; }
    
    p { margin-bottom: 1.25rem; color: var(--text-muted); font-size: 1.05rem; }
    a { color: var(--primary); text-decoration: none; transition: color 0.2s; }
    a:hover { color: var(--secondary); }
    strong { color: #fff; font-weight: 600; }
    
    ul, ol { margin-bottom: 1.5rem; padding-left: 1.5rem; color: var(--text-muted); }
    li { margin-bottom: 0.5rem; }

    /* Layout */
    .layout { display: flex; min-height: 100vh; }
    
    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      position: fixed;
      top: 0;
      bottom: 0;
      left: 0;
      background: var(--bg-panel);
      border-right: 1px solid var(--border);
      overflow-y: auto;
      z-index: 50;
      padding: 2rem 0;
    }
    .sidebar-header { padding: 0 1.5rem 2rem; display: flex; align-items: center; gap: 0.75rem; }
    .logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary), var(--secondary)); border-radius: 8px; display: grid; place-items: center; font-weight: 900; color: #fff; }
    .logo-text { font-size: 1.25rem; font-weight: 700; color: #fff; }
    
    .nav-group { margin-bottom: 2rem; }
    .nav-title { padding: 0 1.5rem; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); font-weight: 700; margin-bottom: 0.75rem; }
    .nav-link { display: block; padding: 0.5rem 1.5rem; color: var(--text-muted); font-size: 0.9rem; transition: all 0.2s; border-left: 2px solid transparent; }
    .nav-link:hover { color: #fff; background: rgba(255,255,255,0.03); }
    .nav-link.active { color: var(--primary); border-left-color: var(--primary); background: var(--primary-dim); font-weight: 500; }

    /* Main Content */
    .main-content {
      margin-left: var(--sidebar-width);
      flex: 1;
      padding: 4rem 5rem;
      max-width: 1200px;
    }

    /* Code Blocks */
    pre {
      background: var(--code-bg);
      border: 1px solid var(--border);
      border-radius: 0.75rem;
      padding: 1.5rem;
      overflow-x: auto;
      margin: 1.5rem 0 2.5rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      line-height: 1.7;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    :not(pre) > code {
      font-family: 'JetBrains Mono', monospace;
      background: var(--primary-dim);
      color: var(--primary);
      padding: 0.2rem 0.4rem;
      border-radius: 0.25rem;
      font-size: 0.85em;
    }
    
    /* Code Highlighting Simulation */
    .token.k { color: #c084fc; } /* keyword */
    .token.s { color: #86efac; } /* string */
    .token.f { color: #38bdf8; } /* function */
    .token.c { color: #64748b; font-style: italic; } /* comment */
    .token.t { color: #2dd4bf; } /* type */
    .token.v { color: #fca5a5; } /* variable */

    /* Components */
    .badge { display: inline-flex; align-items: center; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
    .badge-primary { background: var(--primary-dim); color: var(--primary); border: 1px solid rgba(56, 189, 248, 0.2); }
    
    .alert { padding: 1.25rem; border-radius: 0.75rem; border-left: 4px solid; margin: 2rem 0; background: rgba(30, 41, 59, 0.5); }
    .alert-info { border-color: var(--primary); }
    .alert-warn { border-color: var(--warning); }
    .alert-danger { border-color: var(--danger); }
    .alert-title { display: block; font-weight: 700; margin-bottom: 0.5rem; color: #fff; }

    .grid-features { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin: 3rem 0; }
    .feature-card { background: var(--bg-card); padding: 1.5rem; border-radius: 1rem; border: 1px solid var(--border); transition: transform 0.2s, border-color 0.2s; }
    .feature-card:hover { transform: translateY(-2px); border-color: var(--primary); }
    .feature-icon { width: 48px; height: 48px; background: var(--bg-panel); border-radius: 12px; display: grid; place-items: center; font-size: 1.5rem; margin-bottom: 1rem; color: var(--primary); }

    /* Directory Tree */
    .tree { font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; color: var(--text-muted); }
    .tree-item { padding: 0.25rem 0; display: flex; align-items: center; }
    .tree-icon { margin-right: 0.75rem; color: var(--border); }
    .tree-name { color: var(--text-main); }
    .tree-desc { margin-left: auto; color: var(--text-muted); font-size: 0.8rem; font-style: italic; }

    /* Responsive */
    @media (max-width: 1024px) {
      .sidebar { transform: translateX(-100%); transition: transform 0.3s; }
      .sidebar.open { transform: translateX(0); }
      .main-content { margin-left: 0; padding: 2rem; }
    }
  </style>
</head>
<body>

  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo-icon">B</div>
        <div class="logo-text">Bastion <span style="color:var(--primary)">PHP</span></div>
      </div>

      <nav>
        <div class="nav-group">
          <div class="nav-title">Overview</div>
          <a href="#introduction" class="nav-link">Introduction</a>
          <a href="#architecture" class="nav-link">Architecture Logic</a>
          <a href="#directory-structure" class="nav-link">Directory Structure</a>
        </div>

        <div class="nav-group">
          <div class="nav-title">The Core</div>
          <a href="#ioc-container" class="nav-link">IoC Container</a>
          <a href="#service-providers" class="nav-link">Service Providers</a>
          <a href="#facades-helpers" class="nav-link">Facades & Helpers</a>
          <a href="#config-system" class="nav-link">Configuration</a>
        </div>

        <div class="nav-group">
          <div class="nav-title">Routing & State</div>
          <a href="#hybrid-router" class="nav-link">Hybrid Router</a>
          <a href="#api-endpoints" class="nav-link">API (+server.php)</a>
          <a href="#page-views" class="nav-link">UI Pages (page.php)</a>
          <a href="#dv-engine" class="nav-link" style="color:var(--accent)">DV Engine (State)</a>
        </div>

        <div class="nav-group">
          <div class="nav-title">Data & Models</div>
          <a href="#database-orm" class="nav-link">Database & ORM</a>
          <a href="#migrations" class="nav-link">Migrations & Schema</a>
          <a href="#query-builder" class="nav-link">Query Builder</a>
        </div>

        <div class="nav-group">
          <div class="nav-title">Frontend</div>
          <a href="#tailwind-v4" class="nav-link">Tailwind v4 (CSS-First)</a>
          <a href="#components" class="nav-link">Functional Components</a>
          <a href="#htmx" class="nav-link">HTMX Integration</a>
        </div>

        <div class="nav-group">
          <div class="nav-title">Security & CLI</div>
          <a href="#security" class="nav-link">Security Protocols</a>
          <a href="#bastion-cli" class="nav-link">Bastion CLI</a>
          <a href="#deployment" class="nav-link">Deployment</a>
        </div>
      </nav>
    </aside>

    <main class="main-content">
      
      <section id="introduction" class="mb-20">
        <div class="badge badge-primary mb-4">v1.0.0 Stable</div>
        <h1>The Fortress for your<br>Internal Tools.</h1>
        <p class="text-xl mt-6 max-w-3xl">
          Bastion is an <strong>Enterprise-Grade PHP Framework</strong> designed for the modern era. 
          It abandons the "vendor-lock" of traditional frameworks in favor of a 
          <strong>Monolith Modular Architecture</strong> that lives entirely within your project.
        </p>
        
        <div class="grid-features">
          <div class="feature-card">
            <div class="feature-icon">üèóÔ∏è</div>
            <h3>Monolith Modular</h3>
            <p>The entire framework core lives in <code>app/core/</code>. You own 100% of the code. No black magic in <code>vendor/</code>.</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">‚ö°</div>
            <h3>Hybrid Routing</h3>
            <p>Combines the best of <strong>Next.js</strong> (File-based Routing) and <strong>FastAPI</strong> (Typed API Endpoints).</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">üé®</div>
            <h3>Tailwind v4 Native</h3>
            <p>Built for the future with <strong>CSS-First configuration</strong>. No <code>tailwind.config.js</code> required.</p>
          </div>
        </div>
      </section>

      <hr class="border-gray-800 my-16">

      <section id="architecture" class="scroll-mt-24 mb-20">
        <h2>Architecture Logic</h2>
        <p>
          Most PHP frameworks (Laravel, Symfony) hide their logic deep inside the <code>vendor</code> folder. 
          Bastion takes a different approach: <strong>Transparency</strong>.
        </p>
        <p>
          When you install Bastion, the kernel is scaffolded directly into <code>app/core/</code>. 
          This means if you need to change how the Router handles regex, or how the Auth system sets cookies, 
          you simply edit the file. You don't "extend" the framework; you <strong>are</strong> the framework.
        </p>
        
        <div class="alert alert-info">
          <span class="alert-title">The "Battery Pack" Philosophy</span>
          Bastion comes with zero-dependency implementations of JWT, QueryBuilder, and Migrations. 
          We rely on <code>composer</code> only for low-level utilities (DotEnv, PHP-JWT helper), keeping the core logic clear and debuggable.
        </div>
      </section>

      <section id="directory-structure" class="scroll-mt-24 mb-20">
        <h2>Directory Structure</h2>
        <p>A place for everything, and everything in its place.</p>
        
        <div class="bg-[#0B1120] border border-gray-700 rounded-xl p-6 font-mono text-sm">
          <div class="tree">
            <div class="tree-item"><span class="tree-icon">üìÇ</span> <span class="tree-name text-blue-400">app/</span></div>
            <div class="tree-item pl-6"><span class="tree-icon">üìÇ</span> <span class="tree-name text-purple-400">api/</span> <span class="tree-desc">API Endpoints (+server.php)</span></div>
            <div class="tree-item pl-6"><span class="tree-icon">üìÇ</span> <span class="tree-name text-yellow-400">components/</span> <span class="tree-desc">Functional UI Components</span></div>
            <div class="tree-item pl-6"><span class="tree-icon">üìÇ</span> <span class="tree-name text-red-400">core/</span> <span class="tree-desc">THE FRAMEWORK KERNEL (Do not touch unless necessary)</span></div>
            <div class="tree-item pl-6"><span class="tree-icon">üìÇ</span> <span class="tree-name text-green-400">models/</span> <span class="tree-desc">Database Models</span></div>
            <div class="tree-item pl-6"><span class="tree-icon">üìÇ</span> <span class="tree-name text-blue-400">dashboard/</span> <span class="tree-desc">Route: /dashboard</span></div>
            <div class="tree-item pl-6"><span class="tree-icon">üìÑ</span> <span class="tree-name">page.php</span> <span class="tree-desc">Root Route (/)</span></div>
            
            <div class="tree-item mt-4"><span class="tree-icon">üìÇ</span> <span class="tree-name text-blue-400">config/</span> <span class="tree-desc">App Configuration</span></div>
            <div class="tree-item"><span class="tree-icon">üìÇ</span> <span class="tree-name text-blue-400">database/</span> <span class="tree-desc">Migrations & Seeds</span></div>
            <div class="tree-item"><span class="tree-icon">üìÇ</span> <span class="tree-name text-blue-400">public/</span> <span class="tree-desc">Web Root (index.php)</span></div>
            <div class="tree-item"><span class="tree-icon">üìÇ</span> <span class="tree-name text-blue-400">resources/</span> <span class="tree-desc">CSS & JS Assets</span></div>
            <div class="tree-item"><span class="tree-icon">üìÇ</span> <span class="tree-name text-blue-400">storage/</span> <span class="tree-desc">Logs, DB, Cache (Secured)</span></div>
            <div class="tree-item mt-4"><span class="tree-icon">‚öôÔ∏è</span> <span class="tree-name">bastion</span> <span class="tree-desc">CLI Tool</span></div>
          </div>
        </div>
      </section>

      <section id="ioc-container" class="scroll-mt-24 mb-20">
        <h2>The IoC Container</h2>
        <p>
          At the heart of Bastion is a powerful <strong>Inversion of Control (IoC) Container</strong>. 
          It manages class dependencies and performs dependency injection automatically.
        </p>

        <h3>Automatic Injection</h3>
        <p>
          You rarely need to instantiate classes manually. Type-hint dependencies in your constructors or methods, 
          and the container will resolve them.
        </p>

<pre><code class="language-php"><span class="token c">// Inside a Controller or Service</span>
<span class="token k">use</span> App\Core\Auth;
<span class="token k">use</span> App\Core\Http\Request;

<span class="token k">class</span> <span class="token t">UserController</span> {
    <span class="token k">protected</span> <span class="token v">$auth</span>;
    <span class="token k">protected</span> <span class="token v">$request</span>;

    <span class="token c">// The container automatically injects Auth and Request instances</span>
    <span class="token k">public function</span> <span class="token f">__construct</span>(Auth <span class="token v">$auth</span>, Request <span class="token v">$request</span>) {
        <span class="token v">$this</span>->auth = <span class="token v">$auth</span>;
        <span class="token v">$this</span>->request = <span class="token v">$request</span>;
    }
}</code></pre>

        <h3>Manual Binding</h3>
        <p>In your Service Providers, you can bind interfaces to implementations or create singletons.</p>

<pre><code class="language-php"><span class="token c">// app/providers/AppServiceProvider.php</span>

<span class="token k">public function</span> <span class="token f">register</span>() {
    <span class="token c">// Singleton: Same instance every time</span>
    <span class="token v">$this</span>->app-><span class="token f">singleton</span>(PaymentGateway::class, <span class="token k">function</span>() {
        <span class="token k">return new</span> StripeGateway(env(<span class="token s">'STRIPE_KEY'</span>));
    });
}</code></pre>
      </section>

      <section id="hybrid-router" class="scroll-mt-24 mb-20">
        <h2>Hybrid Routing System</h2>
        <p>
          Bastion introduces a unique routing paradigm that separates <strong>UI Logic</strong> from <strong>Data Logic</strong> 
          using file conventions.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
          <div class="bg-[#0B1120] border border-gray-700 rounded-xl p-6">
            <h4 class="mt-0 text-blue-400">1. UI Routes (page.php)</h4>
            <p class="text-sm">Used for rendering HTML. Executed when the user visits the URL in the browser.</p>
            <ul class="text-sm">
              <li>Returns HTML (via View/Layouts).</li>
              <li>Has access to <code>DV::set()</code> for state.</li>
              <li>Can use <code>layout.php</code> for wrapping.</li>
            </ul>
            <div class="mt-4 p-2 bg-black rounded border border-gray-800 font-mono text-xs">
              app/dashboard/page.php -> /dashboard
            </div>
          </div>

          <div class="bg-[#0B1120] border border-gray-700 rounded-xl p-6">
            <h4 class="mt-0 text-purple-400">2. API Routes (+server.php)</h4>
            <p class="text-sm">Used for handling data submissions (POST, DELETE) or JSON APIs.</p>
            <ul class="text-sm">
              <li>Returns an array of Closures.</li>
              <li>Strict HTTP Method handling.</li>
              <li>Returns JSON automatically.</li>
            </ul>
            <div class="mt-4 p-2 bg-black rounded border border-gray-800 font-mono text-xs">
              app/api/users/+server.php -> /api/users
            </div>
          </div>
        </div>

        <h3 class="mt-12">Dynamic Parameters</h3>
        <p>Use square brackets <code>[param]</code> to define dynamic segments.</p>

<pre><code class="language-php"><span class="token c">// File: app/users/[id]/page.php</span>
<span class="token c">// URL: /users/42</span>

<span class="token v">$id</span> = <span class="token v">$request</span>->attributes[<span class="token s">'id'</span>]; <span class="token c">// 42</span>
<span class="token v">$user</span> = User::<span class="token f">find</span>(<span class="token v">$id</span>);
</code></pre>
      </section>

      <section id="dv-engine" class="scroll-mt-24 mb-20">
        <h2>The DV Engine (Data View)</h2>
        <div class="alert alert-warn">
          <span class="alert-title">Solving the Global Variable Problem</span>
          In traditional PHP, passing data from a child script (<code>page.php</code>) to a parent wrapper (<code>layout.php</code>) 
          often requires global variables. <strong>Bastion eliminates this.</strong>
        </div>

        <p>
          The <code>DV</code> class is a static state container that persists data across the request lifecycle 
          and can "Flash" data to the session for the next request.
        </p>

<pre><code class="language-php"><span class="token c">// 1. In app/dashboard/page.php (Controller Logic)</span>
<span class="token k">use</span> App\Core\DV;

<span class="token c">// Set data for the view</span>
DV::<span class="token f">set</span>(<span class="token s">'title'</span>, <span class="token s">'Sales Dashboard'</span>);
DV::<span class="token f">set</span>(<span class="token s">'stats'</span>, [<span class="token s">'revenue'</span> => <span class="token n">5000</span>]);

<span class="token c">// 2. In app/views/layouts/app.php (View Logic)</span>
&lt;title&gt;<span class="token f">&lt;?=</span> DV::<span class="token f">get</span>(<span class="token s">'title'</span>, <span class="token s">'Default Title'</span>) <span class="token f">?&gt;</span>&lt;/title&gt;

&lt;div&gt;Revenue: <span class="token f">&lt;?=</span> DV::<span class="token f">get</span>(<span class="token s">'stats'</span>)[<span class="token s">'revenue'</span>] <span class="token f">?&gt;</span>&lt;/div&gt;
</code></pre>
      </section>

      <section id="database-orm" class="scroll-mt-24 mb-20">
        <h2>Database & ORM</h2>
        <p>
          Bastion includes a powerful Query Builder and an Active Record implementation similar to Eloquent.
          It supports <strong>SQLite (WAL Mode)</strong>, MySQL, and PostgreSQL out of the box.
        </p>

        <h3>The Model</h3>
<pre><code class="language-php"><span class="token k">namespace</span> App\Models;
<span class="token k">use</span> App\Core\Database\Model;

<span class="token k">class</span> <span class="token t">User</span> <span class="token k">extends</span> <span class="token t">Model</span> {
    <span class="token k">protected static string</span> <span class="token v">$table</span> = <span class="token s">'users'</span>;
}

<span class="token c">// Usage</span>
<span class="token v">$users</span> = User::<span class="token f">where</span>(<span class="token s">'role'</span>, <span class="token s">'admin'</span>)-><span class="token f">get</span>();
<span class="token v">$user</span> = User::<span class="token f">create</span>([<span class="token s">'name'</span> => <span class="token s">'Bastion'</span>, <span class="token s">'email'</span> => <span class="token s">'admin@bastion.com'</span>]);
</code></pre>

        <h3>Fluent Query Builder</h3>
<pre><code class="language-php"><span class="token k">use</span> App\Core\Database\DB;

<span class="token v">$result</span> = DB::<span class="token f">table</span>(<span class="token s">'orders'</span>)
    -><span class="token f">select</span>(<span class="token s">'id'</span>, <span class="token s">'total'</span>)
    -><span class="token f">where</span>(<span class="token s">'status'</span>, <span class="token s">'paid'</span>)
    -><span class="token f">orderBy</span>(<span class="token s">'created_at'</span>, <span class="token s">'desc'</span>)
    -><span class="token f">limit</span>(<span class="token n">10</span>)
    -><span class="token f">get</span>();
</code></pre>
      </section>

      ```

### Parte 2: Frontend, Seguridad, CLI y Despliegue

Esta parte cubre la integraci√≥n de **Tailwind v4**, el sistema de seguridad (JWT, CSRF), la herramienta CLI `bastion` y la gu√≠a de despliegue.

**(Copia y pega esto justo despu√©s de la Parte 1)**

```html
      <section id="tailwind-v4" class="scroll-mt-24 mb-20">
        <h2>Frontend: Tailwind v4 (CSS-First)</h2>
        <div class="alert alert-warn">
          <span class="alert-title">No more JS Config</span>
          Bastion v1.0.0 embraces the <strong>Tailwind CSS v4</strong> architecture. 
          We no longer use <code>tailwind.config.js</code>. All configuration lives in your CSS.
        </div>

        <h3>Theme Configuration</h3>
        <p>Edit <code>resources/css/app.css</code> to configure your theme variables and imports.</p>

<pre><code class="language-css"><span class="token c">/* resources/css/app.css */</span>
<span class="token k">@import</span> "tailwindcss";

<span class="token k">@theme</span> {
  <span class="token c">/* Define custom colors */</span>
  --color-slate-950: #020617;
  
  <span class="token c">/* Define fonts */</span>
  --font-sans: 'Inter', sans-serif;
  --font-mono: 'JetBrains Mono', monospace;
}

<span class="token k">@layer</span> components {
  .btn-primary {
    <span class="token k">@apply</span> bg-sky-500 text-white px-4 py-2 rounded hover:bg-sky-600 transition;
  }
}</code></pre>

        <h3>Building Assets</h3>
        <p>We use the new <strong>Oxide Engine</strong> (Rust-based) via the CLI for lightning-fast builds.</p>
<pre><code class="language-bash"><span class="token c"># Watch for changes (JIT)</span>
npm run dev

<span class="token c"># Build for Production (Minified)</span>
npm run build</code></pre>
      </section>

      <section id="components" class="scroll-mt-24 mb-20">
        <h2>Functional Components</h2>
        <p>
          Why use a heavy template engine like Blade or Twig when PHP 8+ is already fast and expressive?
          Bastion uses <strong>Functional Components</strong>: simple PHP functions that return HTML strings.
        </p>

<pre><code class="language-php"><span class="token c">// app/components/Alert.php</span>
<span class="token k">function</span> <span class="token f">Alert</span>(<span class="token v">$message</span>, <span class="token v">$type</span> = <span class="token s">'info'</span>) {
    <span class="token v">$color</span> = <span class="token v">$type</span> === <span class="token s">'error'</span> ? <span class="token s">'red'</span> : <span class="token s">'blue'</span>;
    <span class="token k">return</span> &lt;&lt;&lt;HTML
    &lt;div class="p-4 bg-<span class="token v">$color</span>-100 text-<span class="token v">$color</span>-800 rounded border border-<span class="token v">$color</span>-200"&gt;
        <span class="token v">$message</span>
    &lt;/div&gt;
    HTML;
}

<span class="token c">// Usage in any view/page:</span>
<span class="token f">&lt;?=</span> <span class="token f">component</span>(<span class="token s">'Alert'</span>, [<span class="token s">'message'</span> => <span class="token s">'User Saved!'</span>, <span class="token s">'type'</span> => <span class="token s">'success'</span>]) <span class="token f">?&gt;</span>
</code></pre>
      </section>

      <section id="security" class="scroll-mt-24 mb-20">
        <h2>Security Protocols</h2>
        <p>Bastion is designed for internal tools where security is non-negotiable. We implement a <strong>Defense in Depth</strong> strategy.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
          <div class="feature-card">
            <h4>Native JWT</h4>
            <p class="text-sm text-gray-400">Zero-dependency implementation using OpenSSL. Handles <code>HttpOnly</code> cookies for Refresh Tokens automatically.</p>
          </div>
          <div class="feature-card">
            <h4>CSRF Protection</h4>
            <p class="text-sm text-gray-400">Middleware automatically verifies tokens on all state-changing methods (POST, PUT, DELETE).</p>
          </div>
          <div class="feature-card">
            <h4>XSS Prevention</h4>
            <p class="text-sm text-gray-400">The global <code>e()</code> helper escapes all output. CSP headers are configured by default.</p>
          </div>
          <div class="feature-card">
            <h4>Encryption Service</h4>
            <p class="text-sm text-gray-400">AES-256-CBC encryption service accessible via <code>app('encrypter')</code>.</p>
          </div>
        </div>
      </section>

      <section id="bastion-cli" class="scroll-mt-24 mb-20">
        <h2>The Bastion CLI</h2>
        <p>
          Say goodbye to Artisan. Bastion includes its own lightweight console application located at the project root.
        </p>

<pre><code class="language-bash"><span class="token c"># List available commands</span>
php bastion

<span class="token c"># Start Development Server</span>
php bastion serve

<span class="token c"># Run Database Migrations</span>
php bastion migrate

<span class="token c"># Seed Database</span>
php bastion db:seed

<span class="token c"># Scaffold a New Page</span>
php bastion make:page dashboard/stats</code></pre>
      </section>

      <section id="deployment" class="scroll-mt-24 mb-20">
        <h2>Deployment</h2>
        <p>Deploying Bastion is simple because it relies on standard PHP technologies.</p>

        <h3 class="mt-8">1. Requirements</h3>
        <ul class="text-sm">
          <li>PHP 8.1+</li>
          <li>Nginx or Apache</li>
          <li>SQLite, MySQL, or PostgreSQL</li>
        </ul>

        <h3 class="mt-8">2. Nginx Configuration</h3>
        <p>Point your web server root to the <code>public/</code> directory.</p>

<pre><code class="language-nginx">server {
    listen 80;
    server_name my-tool.internal;
    root /var/www/bastion/public;
    
    index index.php;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
    }
    
    # Security: Deny access to .env and storage
    location ~ /\.(?!well-known).* {
        deny all;
    }
}</code></pre>

        <h3 class="mt-8">3. Production Checklist</h3>
        <div class="bg-gray-900 border border-gray-700 rounded p-4">
          <ul class="list-none pl-0 mb-0">
            <li>‚úÖ Run <code>composer install --no-dev --optimize-autoloader</code></li>
            <li>‚úÖ Run <code>npm run build</code> to generate minified CSS</li>
            <li>‚úÖ Set <code>APP_ENV=production</code> in <code>.env</code></li>
            <li>‚úÖ Set <code>APP_DEBUG=false</code></li>
            <li>‚úÖ Ensure <code>storage/</code> directory is writable by the web server user</li>
          </ul>
        </div>
      </section>

      <footer class="mt-24 pt-12 border-t border-gray-800 text-center text-gray-500 text-sm pb-12">
        <p>&copy; 2025 Bastion Framework. Released under MIT License.</p>
        <p>Forged for the bold. Built for the enterprise.</p>
      </footer>

    </main>
  </div>

  <script>
    // Simple Scrollspy for Sidebar
    const links = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('section');

    window.addEventListener('scroll', () => {
      let current = '';
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        if (pageYOffset >= sectionTop - 100) {
          current = section.getAttribute('id');
        }
      });

      links.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href').includes(current)) {
          link.classList.add('active');
        }
      });
    });
  </script>
</body>
</html>
