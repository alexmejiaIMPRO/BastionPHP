<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bastion PHP â€” Developer Documentation</title>

  <!-- Exhaustive styling (vanilla CSS + utility helpers) -->
  <style>
    :root {
      --bg-main: #0f172a;
      --bg-card: #1e293b;
      --border:  #334155;
      --text:    #f1f5f9;
      --accent:  #38bdf8;
      --danger:  #f87171;
      --success: #4ade80;
    }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg-main);
      color: var(--text);
      margin: 0;
      line-height: 1.6;
    }
    nav {
      border-bottom: 1px solid var(--border);
      background: var(--bg-card);
      padding: 1rem;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    nav h1 { margin: 0; font-size: 1.5rem; }
    main { max-width: 900px; margin: 2rem auto; padding: 0 1.5rem; }
    section { margin-bottom: 3rem; }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.25rem;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .badge {
      display: inline-block;
      font-size: 0.75rem;
      padding: 0.3em 0.7em;
      border-radius: 30px;
      border: 1px solid transparent;
    }
    .badge.success {
      background: var(--success);
      border-color: #22c55e;
      color: #064e3b;
    }
    .badge.danger {
      background: var(--danger);
      border-color: #ef4444;
      color: #450a0a;
    }

    a { color: var(--accent); text-decoration: none; transition: opacity .2s; }
    a:hover { opacity: .7; }
    h2 { font-size: 2rem; margin-bottom: .5em; font-weight: 700; }
    h3 { font-size: 1.4rem; margin-top: 1.5em; font-weight: 600; }
    ul.tree { font-family: monospace; }
    ul.tree li { list-style: none; margin-left: 1rem; position: relative; }
    ul.tree li::before { content: "â”œâ”€â”€ "; color: var(--accent); }
    ul.tree li:last-child::before { content: "â””â”€â”€ "; color: var(--accent); }

    .endpoint {
      padding: .25rem .5rem;
      background: #0ea5e9;
      color: #000;
      font-family: monospace;
      font-size: .85rem;
      border-radius: 6px;
    }

    pre.code-block {
      background:#020617;
      border:1px solid var(--border);
      padding:1rem;
      border-radius:12px;
      font-size:.85rem;
      overflow-x:auto;
      box-shadow:0 4px 10px rgba(0,0,0,0.4);
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-top: 1rem;
    }

    /* Optional JS transition helpers */
    .fade {
      opacity: 0;
      animation: fadeIn .4s forwards;
    }
    @keyframes fadeIn { to { opacity:1; } }

  </style>
</head>
<body>

<nav>
  <h1>Bastion PHP Framework â€” Developer Documentation (v0.1.0)</h1>
</nav>

<main>

<section>
  <h2>ğŸš€ Getting Started</h2>
  <div class="card">
    <p>Generate a new project:</p>
    <pre class="code-block">./create-bastion-app my-tool</pre>
    <p>Run locally:</p>
    <pre class="code-block">
composer install
./bastion migrate
./bastion seed
./bastion run-dev
    </pre>
    <p>The app will be available at <span class="endpoint">:8000</span> and BrowserSync proxy at <span class="endpoint">:9876</span>.</p>
  </div>
</section>

<section>
  <h2>ğŸ§± File-Based Routing & Layout System (Like Next.js)</h2>
  <div class="card">
    <p>The router resolves nested layouts by walking the request path:</p>
    <p><span class="endpoint">/admin/users/settings</span> resolves stack:</p>
    <ul class="tree">
      <li>app/admin/users/settings/layout.php (if exists)</li>
      <li>app/admin/users/layout.php</li>
      <li>app/admin/layout.php</li>
      <li>app/layout.php (root fallback)</li>
    </ul>
    <p>Each layout can wrap the inner content by calling <code>$content()</code>:</p>

    <h3>Example folder layout</h3>
    <pre class="code-block">
<?php declare(strict_types=1); ?>
<div class="p-4 border border-slate-800 rounded-xl bg-slate-900/60">
   <?php $content(); ?>
</div>
    </pre>
  </div>
</section>

<section>
  <h2>ğŸ§  Admin Panel (Django-Inspired)</h2>
  <div class="card">
    <p>Navigate to:</p>
    <ul class="text-sm">
       <li><span class="endpoint">/login</span> â†’ default seeded login (admin@example.com / admin123)</li>
       <li><span class="endpoint">/admin</span> â†’ protected dashboard</li>
       <li><span class="endpoint">/admin/users</span> â†’ filterable table</li>
    </ul>
  </div>
</section>

<section>
  <h2>ğŸ§° Components System</h2>
  <div class="card">
    <p>Reusable UI components live at:</p>
    <ul class="tree">
      <li>resources/views/components/navbar.php</li>
      <li>resources/views/components/flash.php</li>
      <li>resources/views/components/table.php</li>
      <li>resources/views/components/searchbar.php</li>
      <li>You can extend this folder like a minimal UI kit</li>
    </ul>

    <h3>Public Navbar component</h3>
    <pre class="code-block">
<nav class="border-b border-slate-700 bg-slate-900/90 px-4 py-3">
   <div class="max-w-6xl mx-auto flex justify-between">
      <a href="/">Home</a>
      <a href="/admin">Admin</a>
   </div>
</nav>
    </pre>
  </div>
</section>

<section>
  <h2>ğŸ” Middlewares & Security</h2>
  <div class="card">
    <ul class="tree">
      <li>SecurityHeaders â†’ sets CSP + Nonce + frame protection</li>
      <li>AuthMiddleware â†’ validates user and CSRF when enabled</li>
      <li>AdminOnly â†’ protects anything under `/admin/*`</li>
      <li>RateLimit â†’ stub ready for IP-rate limiting</li>
    </ul>

    <h3>CSRF Token Usage</h3>
    <pre class="code-block">
<input type="hidden" name="_token" value="<?= e(CSRF::token()) ?>">
    </pre>

    <h3>CSP safe script/style tags</h3>
    <pre class="code-block">
<script nonce="<?= e($_SESSION['csp_nonce']) ?>" src="..."></script>
<style nonce="<?= e($_SESSION['csp_nonce']) ?>"></style>
    </pre>
  </div>
</section>

<section>
  <h2>ğŸ—„ Database & Query Builder</h2>
  <div class="card">
    <p>Examples:</p>
    <pre class="code-block">
DB::table('users')->where('id',1)->first();
DB::table('users')->orderBy('id','DESC')->limit(10)->get();
DB::table('users')->insert(['name'=>'Sunset']);
    </pre>
  </div>
</section>

<section>
  <h2>ğŸ§¬ Migrations & Seeds</h2>
  <div class="card">
    <p>Create a migration manually at <span class="endpoint">database/migrations/NNN_description.sql</span></p>
    <p>Run:</p>
    <pre class="code-block">./bastion migrate</pre>
    <p>Seed demo users:</p>
    <pre class="code-block">./bastion seed</pre>
  </div>
</section>

<section>
  <h2>ğŸ§ª Testing Stubs</h2>
  <div class="card">
    <p>You can later expand tests using:</p>
    <pre class="code-block">
playwright tests â†’ E2E browser automation (you'll expand this later)
phpunit tests   â†’ for your core facades and QueryBuilder
    </pre>
    <p>Stub example for E2E (to be expanded):</p>
    <pre class="code-block">
// e.g: tests/e2e/login.spec.js
test('user can login', async () => { /* implement */ });
    </pre>
  </div>
</section>

<section class="text-center">
   <p class="text-slate-500">Bastion PHP Â© 2025 â€” Built for speed and security.</p>
</section>

</main>
</body>
</html>